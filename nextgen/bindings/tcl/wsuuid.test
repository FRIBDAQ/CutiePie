#
#  Tests for the ::spectcl::wsUUID command.
#
package require tcltest

load .libs/libSpecTclExperiment.so
namespace import ::tcltest::*


#-------------------------- The tests ----------------

test exists {wsUUID command must exist} \
    -body {
	info commands ::spectcl::wsUUID
    } -result ::spectcl::wsUUID

test fail_2 {wsUUID requires the database handle be that of a workspace} \
    -setup {
	file delete ./exp.db
	set handle [::spectcl::expcreate ./exp.db]
    } \
    -cleanup {
	::spectcl::expclose $handle
	file delete ./exp.db
    } \
     -body {
	 set status [catch {::spectcl::wsUUID $handle} msg]
	 list $status $msg
     } -result [list 1 "NOT_WORKSPACE - The database is not a workspace"]
test ok_1 {wsUUID uuid should match the one in the associated experiment database} \
    -setup {
	file delete ./exp.db
	file delete ./ws.db

	set exp [::spectcl::expcreate ./exp.db]
	::spectcl::wsCreate $exp ./ws.db
	set ws [::spectcl::wsOpen ./ws.db]
	
    } \
    -cleanup {
	::spectcl::wsClose $ws
	::spectcl::expclose $exp

	file delete ./exp.db
	file delete ./ws.db
	
    } \
    -body {
	set wsUUID  [::spectcl::wsUUID $ws]
	set expUUID [::spectcl::expuuid check $exp $wsUUID]
    } \
    -result 1

cleanupTests
