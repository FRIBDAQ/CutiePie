<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>CEventFilter</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="SpecTcl Programming Reference."
HREF="index.html"><LINK
REL="UP"
TITLE="Core SpecTcl classes"
HREF="p8474.html"><LINK
REL="PREVIOUS"
TITLE="CEventSink"
HREF="r18269.html"><LINK
REL="NEXT"
TITLE="Stuff to do"
HREF="c18374.html"></HEAD
><BODY
CLASS="refentry"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>SpecTcl Programming Reference.</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="r18269.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="c18374.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="AEN18329"
></A
>CEventFilter</H1
><DIV
CLASS="refnamediv"
><A
NAME="AEN18333"
></A
><H2
>Name</H2
>CEventFilter&nbsp;--&nbsp;Abstract base class for event filters.</DIV
><DIV
CLASS="refsynopsisdiv"
><A
NAME="AEN18336"
></A
><H2
>Synopsis</H2
><FONT
COLOR="RED"
>&#13;class CEventFilter : public CEventSink {
protected:
   Bool_t m_fEnabled;                           
   std::string              m_sFileName;        
   std::vector<FONT
COLOR="RED"
> m_vParameterNames; 
   std::vector<FONT
COLOR="RED"
>      m_vParameterIds;   
   CFilterOutputStage*      m_pOutput;         
 public:
  CEventFilter(std::string&#38; rFileName);
  std::vector&#60;std::string&#62; getParameterNames() const;
  std::vector&#60;UInt_t&#62; getParameterIds() const;
  Bool_t CheckEnabled() const;
  std::string getFileName() const;
  CFilterOutputStage* getOutputStream();

  void setParameterNames(const std::vector&#60;std::string&#62;&#38; names);
  void setOutputStream(CFilterOutputStage* str);
  
  void Enable();
  void Disable();
  void setFileName(std::string&#38;);
  void setOutputFormat(CFilterOutputStage* format);
  std::string outputFormat() const;
  virtual void operator()(CEventList&#38; rEvents);
  virtual void operator()(CEvent&#38; rEvent);      

protected:
   virtual Bool_t CheckCondition(CEvent&#38; rEvent) = 0;
   static std::string DefaultFilterFilename();   
   void NamesToIds();                       
   std::vector&#60;std::string&#62; IdsToNames() 

};

        </FONT
></FONT
></FONT
></DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN18340"
></A
><H2
>DESCRIPTION</H2
><P
>&#13;            Filters are objects that, since they are derived from
            <CODE
CLASS="classname"
>CEventSink</CODE
>, can be added to the
            event sink pipeline.  Filters are expected to operate on
            decoded events.  They have:
        </P
><P
></P
><UL
><LI
><P
>&#13;                    A file to which output data are written
                </P
></LI
><LI
><P
>&#13;                    A list of parameters that will be output.
                </P
></LI
><LI
><P
>&#13;                    A condition that determines which events are written
                </P
></LI
><LI
><P
>&#13;                    A formatting object that determines how the events
                    are written to the output file.
                </P
></LI
></UL
><P
>&#13;            Thus filters create subsets of the raw input data. The output
            of filters both subset the events (writing only those events that
            satisfy their condition), and the parameters (writing only the
            specified parameters).
        </P
><P
>&#13;            Filters can speed up subsequent event processing both by reducing
            the volume of data produced and by writing data in a format much
            easier to decode than the original raw event data.  People using
            filters have reported over an order of magnitude improvement in
            the processing of e.g. XDR formatted filtered data over raw data,
            even when no selection has been performed.
        </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN18355"
></A
><H2
>METHODS</H2
><P
></P
><DIV
CLASS="variablelist"
><DL
><DT
><code
class="constructorsynopsis"
>&#13;  CEventFilter(<span
class="methodparam"
><span
class="type"
>std::string&#38;  </span
><span
class="parameter"
>rFileName</span
></span
>);&#13;</code
></DT
><DD
><P
>&#13;                        Constructor.  <CODE
CLASS="parameter"
>rFilename</CODE
> references
                        the name of the file that filtered data will be written
                        into.  The file is not opened by the constructor.
                    </P
></DD
></DL
></DIV
><P
>&#13;  );
  std::vector&#60;std::string&#62; getParameterNames() const;
  std::vector&#60;UInt_t&#62; getParameterIds() const;
  Bool_t CheckEnabled() const;
  std::string getFileName() const;
  CFilterOutputStage* getOutputStream();

  void setParameterNames(const std::vector&#60;std::string&#62;&#38; names);
  void setOutputStream(CFilterOutputStage* str);
  
  void Enable();
  void Disable();
  void setFileName(std::string&#38;);
  void setOutputFormat(CFilterOutputStage* format);
  std::string outputFormat() const;
  virtual void operator()(CEventList&#38; rEvents);
  virtual void operator()(CEvent&#38; rEvent);      

protected:
   virtual Bool_t CheckCondition(CEvent&#38; rEvent) = 0;
   static std::string DefaultFilterFilename();   
   void NamesToIds();                       
   std::vector&#60;std::string&#62; IdsToNames() 
            
        </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN18369"
></A
><H2
>Data Available to subclasses</H2
><P
>&#13;   Bool_t m_fEnabled;                           
   std::string              m_sFileName;        
   std::vector<FONT
COLOR="RED"
> m_vParameterNames; 
   std::vector<FONT
COLOR="RED"
>      m_vParameterIds;   
   CFilterOutputStage*      m_pOutput;         
        </FONT
></FONT
></P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="r18269.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="c18374.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>CEventSink</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="p8474.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Stuff to do</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>